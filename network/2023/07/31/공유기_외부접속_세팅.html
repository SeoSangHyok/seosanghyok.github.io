<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-translate-customization" content="108d9124921d80c3-80e20d618ff053c8-g4f02ec6f3dba68b7-c">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>공유기 외부접속 세팅 | My Dev / Study Archive</title>
<meta name="generator" content="Jekyll v4.3.2">
<meta property="og:title" content="공유기 외부접속 세팅">
<meta name="author" content="Seo Sang Hyok">
<meta property="og:locale" content="en_US">
<meta name="description" content="네트워크나 서버 프로그래밍, DB공부, 개인 파일서버나 원격접속등 외부에서 내 컴퓨터에 접근해야 할일은 상당히 많다. 만약 우리집에 있는 로컬컴퓨터에 원격 데스크탑이 가능하도록 세팅했다고 하자. 그리고 까패나 다른 곳에서 일이 생겨 내 컴퓨터에 원격으로 붙어야 할때 어떻게 하면 될까?">
<meta property="og:description" content="네트워크나 서버 프로그래밍, DB공부, 개인 파일서버나 원격접속등 외부에서 내 컴퓨터에 접근해야 할일은 상당히 많다. 만약 우리집에 있는 로컬컴퓨터에 원격 데스크탑이 가능하도록 세팅했다고 하자. 그리고 까패나 다른 곳에서 일이 생겨 내 컴퓨터에 원격으로 붙어야 할때 어떻게 하면 될까?">
<link rel="canonical" href="/network/2023/07/31/%EA%B3%B5%EC%9C%A0%EA%B8%B0_%EC%99%B8%EB%B6%80%EC%A0%91%EC%86%8D_%EC%84%B8%ED%8C%85.html">
<meta property="og:url" content="/network/2023/07/31/%EA%B3%B5%EC%9C%A0%EA%B8%B0_%EC%99%B8%EB%B6%80%EC%A0%91%EC%86%8D_%EC%84%B8%ED%8C%85.html">
<meta property="og:site_name" content="My Dev / Study Archive">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-07-31T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="공유기 외부접속 세팅">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Seo Sang Hyok"},"dateModified":"2023-07-31T00:00:00+00:00","datePublished":"2023-07-31T00:00:00+00:00","description":"네트워크나 서버 프로그래밍, DB공부, 개인 파일서버나 원격접속등 외부에서 내 컴퓨터에 접근해야 할일은 상당히 많다. 만약 우리집에 있는 로컬컴퓨터에 원격 데스크탑이 가능하도록 세팅했다고 하자. 그리고 까패나 다른 곳에서 일이 생겨 내 컴퓨터에 원격으로 붙어야 할때 어떻게 하면 될까?","headline":"공유기 외부접속 세팅","mainEntityOfPage":{"@type":"WebPage","@id":"/network/2023/07/31/%EA%B3%B5%EC%9C%A0%EA%B8%B0_%EC%99%B8%EB%B6%80%EC%A0%91%EC%86%8D_%EC%84%B8%ED%8C%85.html"},"url":"/network/2023/07/31/%EA%B3%B5%EC%9C%A0%EA%B8%B0_%EC%99%B8%EB%B6%80%EC%A0%91%EC%86%8D_%EC%84%B8%ED%8C%85.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="icon" href="">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-noto-sans@0.0.72/index.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <script src="/assets/js/main.js"></script><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="My Dev / Study Archive">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
<!-- and it's easy to individually load additional languages -->
<script charset="UTF-8" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/go.min.js"></script>



















<script>
// Init highlight js
document.addEventListener('DOMContentLoaded', function(event) {
  var els = document.querySelectorAll('pre code')

  function addLangData(block) {
    var outer = block.parentElement.parentElement.parentElement;
    var lang = block.getAttribute('data-lang');
    for (var i = 0; i < outer.classList.length; i++) {
      var cls = outer.classList[i];
      if (cls.startsWith('language-')) {
        lang = cls;
        break;
      }
    }
    if (!lang) {
      cls = block.getAttribute('class');
      lang = cls ? cls.replace('hljs ', '') : '';
    }
    if (lang.startsWith('language-')) {
      lang = lang.substr(9);
    }
    block.setAttribute('class', 'hljs ' + lang);
    block.parentNode.setAttribute('data-lang', lang);
  }

  function addBadge(block) {
    var enabled = ('true' || 'true').toLowerCase();
    if (enabled == 'true') {
      var pre = block.parentElement;
      pre.classList.add('badge');
    }
  }

  function handle(block) {
    addLangData(block);
    addBadge(block)
    hljs.highlightBlock(block);
  }

  for (var i = 0; i < els.length; i++) {
    var el = els[i];
    handle(el);
  }
});
</script>

<style>
  /* code language badge */
  pre.badge::before {
    content: attr(data-lang);
    color: #fff;
    background-color: #ff4e00;
    padding: 0 .5em;
    border-radius: 0 2px;
    text-transform: uppercase;
    text-align: center;
    min-width: 32px;
    display: inline-block;
    position: absolute;
    right: 0;
  }

  /* fix wrong badge display for firefox browser */
  code > table pre::before {
    display: none;
  }
</style>
</head>
<body>



























































































































<header class="site-header " role="banner">

  <div class="wrapper">
    <div class="site-header-inner">
<span class="site-brand"><a class="site-brand-inner" rel="author" href="/">
  <img class="site-favicon" title="My Dev / Study Archive" src="" onerror="this.style.display='none'">
  My Dev / Study Archive
</a>
</span><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger">
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewbox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
              </svg>
            </span>
          </label>

          <div class="trigger">
<a class="page-link" href="/about.html">ABOUT</a><a class="page-link" href="/archives.html">ARCHIVES</a><a class="page-link" href="/categories.html">CATEGORIES</a><a class="page-link" href="/">HOME</a><a class="page-link" href="/tags.html">TAGS</a>









<span class="page-link">



<div id="google_translate_element" style="display: none;">
</div>

<span class="ct-language">
  <ul class="list-unstyled ct-language-dropdown">
    
      <li>
        <a href="#" class="lang-select" data-lang="en">
          
          <img src="https://cdn.countryflags.com/thumbs/united-states-of-america/flag-400.png" title="English">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="fr">
          
          <img src="https://cdn.countryflags.com/thumbs/france/flag-400.png" title="French">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="zh-CN">
          
          <img src="https://cdn.countryflags.com/thumbs/china/flag-400.png" title="Chinese(Simple)">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ja">
          
          <img src="https://cdn.countryflags.com/thumbs/japan/flag-400.png" title="Japanese">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ko">
          
          <img src="https://cdn.countryflags.com/thumbs/south-korea/flag-400.png" title="Korean">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ru">
          
          <img src="https://cdn.countryflags.com/thumbs/russia/flag-400.png" title="Russian">
          
        </a>
      </li>
    
  </ul>
</span>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: 'en',
    autoDisplay: false,
    layout: google.translate.TranslateElement.InlineLayout.VERTICAL
  }, 'google_translate_element');

  // Links to cross-origin destinations are unsafe
  var gll = document.getElementsByClassName('goog-logo-link')[0];
  if (gll) {
    gll.setAttribute('rel', 'noopener');
  }

  function restoreLang() {
    var iframe = document.getElementsByClassName('goog-te-banner-frame')[0];
    if (!iframe) return;

    var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
    var restore_el = innerDoc.getElementsByTagName("button");

    for (var i = 0; i < restore_el.length; i++) {
      if (restore_el[i].id.indexOf("restore") >= 0) {
        restore_el[i].click();
        var close_el = innerDoc.getElementsByClassName("goog-close-link");
        close_el[0].click();
        return;
      }
    }
  }

  function triggerHtmlEvent(element, eventName) {
    var event;
    if (document.createEvent) {
      event = document.createEvent('HTMLEvents');
      event.initEvent(eventName, true, true);
      element.dispatchEvent(event);
    } else {
      event = document.createEventObject();
      event.eventType = eventName;
      element.fireEvent('on' + event.eventType, event);
    }
  }

  var googleCombo = document.querySelector("select.goog-te-combo");
  var langSelect = document.querySelector('.ct-language');
  langSelect.addEventListener('click', function(event) {
    if (!event.target) {
      return;
    }

    var selected = document.querySelector('.ct-language .ct-language-selected');
    if (selected) {
      selected.classList.remove('ct-language-selected');
    }

    var target = event.target;
    while (target && target !== langSelect ) {
      if (target.matches('.lang-select')) {
        break;
      }
      target = target.parentElement;
    }

    if (target && target.matches('.lang-select')) {
      var lang = target.getAttribute('data-lang');
      if (googleCombo.value == lang) {
        restoreLang();
      } else {
        target.parentElement.classList.add('ct-language-selected');
        googleCombo.value = lang;
        triggerHtmlEvent(googleCombo, 'change');
      }
    }

    event.preventDefault();
  });
}
</script>

<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</span>
</div>
        </nav>
</div>
  </div>
</header>

<script>
  function initHeader() {
    var lastScrollY = getScrollPos().y;
    var documentElement = document.documentElement;

    function storeScrollData() {
      var y = getScrollPos().y;var scrollStatus = "";

      if (y <= 0) {
        scrollStatus = "top";
      } else if ((window.innerHeight + y) >= document.body.offsetHeight) {
        scrollStatus = "bottom";
      } else {
        var isScrollDown = (y - lastScrollY > 0) ? true : false;
        scrollStatus = isScrollDown ? "down" : "up";
      }

      lastScrollY = y;
      documentElement.setAttribute("data-scroll-status", scrollStatus);
    }

    window.addEventListener('scroll', function(e) {
      storeScrollData();
    });

    storeScrollData();
  }
  document.addEventListener('DOMContentLoaded', initHeader);
</script>
















































































































































<script>
  function hashLocate(hashValue) {
    hashValue = hashValue.replace(/^.*#h-/, '');
    hashValue = decodeURIComponent(hashValue);
    var element = document.getElementById(hashValue);

    if (!element) {
      return;
    }

    var header = document.querySelector('header.site-header');
    var headerRect = header.getBoundingClientRect();
    var headerTop = Math.floor(headerRect.top);
    var headerHeight = Math.floor(headerRect.height);
    var scrollPos = getScrollPos();
    var offsetY = element.offsetTop - (headerTop + headerHeight + 20);

    if (offsetY == scrollPos.y) {
      return;
    }

    if (headerTop == 0  && offsetY > scrollPos.y) {
      offsetY += headerHeight + 2;
    } else if (headerTop < 0  && offsetY < scrollPos.y) {
      offsetY -= headerHeight - 2;
    }

    smoothScrollTo(offsetY);
  }

  // The first event occurred
  window.addEventListener('load', function(event) {
    if (window.location.hash) {
      hashLocate(window.location.hash);
    }
  });

  // The first event occurred
  window.addEventListener('click', function(event) {
    if (event.target.tagName.toLowerCase() == 'a') {
      hashLocate(event.target.getAttribute('href'));
    }
  });
</script>
<div class="theme-toggle">
  <input type="checkbox" id="theme-switch">
  <label for="theme-switch">
    <div class="toggle"></div>
    <div class="names">
      <p class="light">Light</p>
      <p class="dark">Dark</p>
    </div>
  </label>
</div>




<script>
  (function() {
    var sw = document.getElementById('theme-switch');
    var html = document.getElementsByTagName('html')[0];
    var nightModeOption = ('auto' || 'auto').toLowerCase();
    var storage = nightModeOption === 'manual'
        ? localStorage
        : sessionStorage;
    var themeData = loadThemeData();

    function saveThemeData(data) {
      storage.setItem('theme', JSON.stringify(data));
    }

    function loadThemeData() {
      var data = storage.getItem('theme');
      try {
        data = JSON.parse(data ? data : '');
      } catch(e) {
        data = { nightShift: undefined, autoToggleAt: 0 };
        saveThemeData(data);
      }
      return data;
    }

    function handleThemeToggle(nightShift) {
      themeData.nightShift = nightShift;
      saveThemeData(themeData);
      html.dataset.theme = nightShift ? 'dark' : 'light';
      setTimeout(function() {
        sw.checked = nightShift ? true : false;
      }, 50);
    }

    function autoThemeToggle() {
      // Next time point of theme toggle
      var now = new Date();
      var toggleAt = new Date();
      var hours = now.getHours();
      var nightShift = hours >= 19 || hours <=7;

      if (nightShift) {
        if (hours > 7) {
          toggleAt.setDate(toggleAt.getDate() + 1);
        }
        toggleAt.setHours(7);
      } else {
        toggleAt.setHours(19);
      }

      toggleAt.setMinutes(0);
      toggleAt.setSeconds(0);
      toggleAt.setMilliseconds(0)

      var delay = toggleAt.getTime() - now.getTime();

      // auto toggle theme mode
      setTimeout(function() {
        handleThemeToggle(!nightShift);
      }, delay);

      return {
        nightShift: nightShift,
        toggleAt: toggleAt.getTime()
      };
    }

    // Listen the theme toggle event
    sw.addEventListener('change', function(event) {
      handleThemeToggle(event.target.checked);
    });

    if (nightModeOption == 'auto') {
      var data = autoThemeToggle();

      // Toggle theme by local setting
      if (data.toggleAt > themeData.autoToggleAt) {
        themeData.autoToggleAt = data.toggleAt;
        handleThemeToggle(data.nightShift);
      } else {
        handleThemeToggle(themeData.nightShift);
      }
    } else if (nightModeOption == 'manual') {
      handleThemeToggle(themeData.nightShift);
    } else {
      var nightShift = themeData.nightShift;
      if (nightShift === undefined) {
        nightShift = nightModeOption === 'on';
      }
      handleThemeToggle(nightShift);
    }
  })();
</script>
<div id="click-to-top" class="click-to-top">
  <i class="fa fa-arrow-up"></i>
</div>
<script>
  (function () {
    const clickToTop = document.getElementById('click-to-top');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 100) {
        clickToTop.classList.add('show')
      }else {
        clickToTop.classList.remove('show')
      }
    });
    clickToTop.addEventListener('click', () => {
      window.smoothScrollTo(0);
    });
  })();
</script>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="framework">
  <section class="main">

     <div class="post">
  <section>









<header class="post-header">
  <h1 class="post-title p-name" itemprop="name headline">공유기 외부접속 세팅</h1>
  <h2 class="post-subtitle">공유기의 DDNS 기능과 포트 포워딩 기능을 이용해서 외부망에서도 접속 내 컴퓨터에 접속할 수 있도록 해보자</h2>

  <p class="post-meta">
    <time class="dt-published" datetime="2023-07-31T00:00:00+00:00" itemprop="datePublished"><i class="fa fa-calendar"></i> Jul 31, 2023
    </time>

    
    
































    <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 6 mins</span>
  </p>
<div class="post-tags">
<a class="post-tag" href="/tags.html#network">#network</a><a class="post-tag" href="/tags.html#%EA%B3%B5%EC%9C%A0%EA%B8%B0">#공유기</a>
</div></header>
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

    <div class="post-content e-content" itemprop="articleBody">

      <p>네트워크나 서버 프로그래밍, DB공부, 개인 파일서버나 원격접속등 외부에서 내 컴퓨터에 접근해야 할일은 상당히 많다. 만약 우리집에 있는 로컬컴퓨터에 원격 데스크탑이 가능하도록 세팅했다고 하자. 그리고 까패나 다른 곳에서 일이 생겨 내 컴퓨터에 원격으로 붙어야 할때 어떻게 하면 될까?</p>

<h2 id="일단-그냥-한번-해보자">일단 그냥 한번 해보자</h2>

<p>원격 데스크탑 세팅이 가능한 사람이라면 CMD(명령프롬프트)창에서 <strong>ipconfig</strong> 명령을 이용해서 자신의 IP정도는 쉽게 확인 할 수 있을것이다. 만약 집이고 공유기를 이용해서 인터넷을 연결중이라면 노트북등 다른 컴퓨터에서 원격으로 붙는것도 손쉽게 가능할 것이다.</p>

<p><img src="/assets/images/2023/07/2023-07-31/01.png" alt="ip확인"></p>

<p><img src="/assets/images/2023/07/2023-07-31/02.png" alt="원격연결1"></p>

<p><img src="/assets/images/2023/07/2023-07-31/03.png" alt="원격연결2"></p>

<h3 id="그런대-만약-다른곳에서-똑같이-한다면">그런대 만약 다른곳에서 똑같이 한다면??</h3>

<p>만약 까페의 인터넷 을 사용하거나 인터넷이 안되는 환경에서 휴대폰 테더링을 통해 인터넷을 하고 있는경우 위에서 한거처럼 똑같은 ip를 넣고 접속이 가능할까?? 당장 까페에 가서 테스트해보자. 굳이 까페에 가지 않더라도 노트북이 있다면 휴대폰 등으로 노트북을 테더링 연결 후 해보자.</p>

<h2 id="왜-안되는-걸까">왜 안되는 걸까??</h2>

<p>바깥에 까페등 다른곳에서 인터넷을 연결한 후 시도한다면 연결이 되지 않을것이다. 왜 안될까?? 아마 대부분 집과 까페에 인터넷을 연결하는 상황은 아래와 같을것이다.</p>

<p><img class="plantuml" src="http://www.plantuml.com/plantuml/svg/~h407374617274756d6c0a407374617274756d6c0a636c6f756420494e5445524e45540a6e6f64652022eca7912220617320486f6d65207b0a636f6d706f6e656e742022ebaaa8eb8e802220617320485f6d6f64656d0a636f6d706f6e656e742022eab3b5ec9ca0eab8b02220617320485f4e41540a72656374616e676c652022ecbbb4ed93a8ed84b05c6e283139322e3136382e302e3531292220617320485f436f6d0a72656374616e676c652022eb85b8ed8ab8ebb6812220617320485f6e6f74650a72656374616e676c652022ed9cb4eb8c80ed8fb02220617320485f70686f6e650a0a485f6d6f64656d202d2d20485f4e41540a485f4e4154202d2d20485f436f6d0a485f4e4154202d2d20485f6e6f74650a485f4e4154202d2d20485f70686f6e650a7d0a0a6e6f6465202263616665222061732043616665207b0a636f6d706f6e656e742022eab3b5ec9ca0eab8b02220617320435f4e41540a6e6f7465206c656674206f6620435f4e41540a20202020eab3b5ec9ca0eab8b0ec998020ebaaa8eb8e80200a20202020eab8b0eb8aa5ec9db420ed9598eb8298ec9790200a20202020eab099ec9db420ec9e88eb8a94200a20202020eab2bdec9ab0eb8f8420ec9e88eb8ba42e0a656e64206e6f74650a72656374616e676c652022eb85b8ed8ab8ebb681312220617320435f6e6f7465310a72656374616e676c652022eb85b8ed8ab8ebb681322220617320435f6e6f7465320a72656374616e676c6520222e2e2e2220617320435f6574630a0a435f4e4154202d2d20435f6e6f7465310a435f4e4154202d2d20435f6e6f7465320a435f4e4154202d2d20435f6574630a7d0a0a494e5445524e4554202d2d20485f6d6f64656d0a494e5445524e4554202d2d20435f4e41540a0a40656e64756d6c0a40656e64756d6c"></p>

<p>이것을 도식화 하면 아래와 같다.</p>

<p><img class="plantuml" src="http://www.plantuml.com/plantuml/svg/~h407374617274756d6c0a407374617274756d6c0a21696e636c756465203c6f66666963652f436f6d6d756e69636174696f6e732f736d735f676174657761793e0a21696e636c756465203c6f66666963652f436f6d6d756e69636174696f6e732f736d74705f636f6e6e6563746f723e0a21696e636c756465203c6f66666963652f436f6d6d756e69636174696f6e732f766f69705f676174657761793e0a21696e636c756465203c6f66666963652f446576696365732f6d6f64656d3e0a21696e636c756465203c6f66666963652f446576696365732f776f726b73746174696f6e3e0a21696e636c756465203c6f66666963652f446576696365732f63656c6c5f70686f6e655f67656e657269633e0a21696e636c756465203c6f66666963652f446576696365732f6465766963655f6c6170746f703e0a0a6e7764696167207b0a20206e6574776f726b20496e7465726e6574207b0a20202020486f6d65526f75746572205b61646472657373203d20223c623e3c636f6c6f723a233030303066663e3131392e3135382e3230302e3134353c2f636f6c6f723e3c2f623e222c206465736372697074696f6e203d20223c24766f69705f676174657761793e5c6eec9db8ed84b0eb84b7ebaaa8eb8e80225d0a2020202043616665526f75746572205b61646472657373203d20223c623e3c636f6c6f723a233030303066663e3138372e3234352e3133312e3131323c2f636f6c6f723e3c2f623e222c206465736372697074696f6e203d20223c246d6f64656d3e5c6eeab98ced8ca8eab3b5ec9ca0eab8b05c6e28ebaaa8eb8e80eab3bc20eab3b5ec9ca0eab8b0eab0805c6eec9dbcecb2b4ed9895ec9db820eab2bdec9ab0eb8f8420ec9e88eb8ba42e29225d0a20207d0a2020486f6d65526f75746572202d2d20486f6d654e41540a2020486f6d654e4154205b61646472657373203d20223c623e3c636f6c6f723a236666303030303e3139322e3136382e302e313c2f636f6c6f723e3c2f623e222c206465736372697074696f6e203d20223c246d6f64656d3e5c6eeca791eab3b5ec9ca0eab8b0225d0a20200a20206e6574776f726b20486f6d65207b0a20202020486f6d654e41540a20202020486f6d65436f6d31205b61646472657373203d20223c623e3c636f6c6f723a236666303030303e3139322e3136382e302e35303c2f636f6c6f723e3c2f623e222c206465736372697074696f6e203d20223c24776f726b73746174696f6e3e5c6eeb8db0ec8aa4ed81aced8391225d0a20202020486f6d65436f6d32205b61646472657373203d20223139322e3136382e302e3730222c206465736372697074696f6e203d20223c246465766963655f6c6170746f703e5c6eeb85b8ed8ab8ebb681225d0a20202020486f6d65436f6d33205b61646472657373203d20223139322e3136382e302e3738222c206465736372697074696f6e203d20223c2463656c6c5f70686f6e655f67656e657269633e5c6eed9cb4eb8c80ed8fb0225d0a20207d0a0a20206e6574776f726b2043616665207b0a2020202043616665526f75746572205b61646472657373203d20223c623e3c636f6c6f723a236666303030303e3139322e3136382e302e313c2f636f6c6f723e3c2f623e225d0a2020202043616665436f6d31205b61646472657373203d20223139322e3136382e302e3330222c206465736372697074696f6e203d20223c24776f726b73746174696f6e3e5c6eeb8db0ec8aa4ed81aced8391225d0a2020202043616665436f6d32205b61646472657373203d20223c623e3c636f6c6f723a236666303030303e3139322e3136382e302e35303c2f636f6c6f723e3c2f623e222c206465736372697074696f6e203d20223c246465766963655f6c6170746f703e5c6eeb85b8ed8ab8ebb68131225d0a2020202043616665436f6d33205b61646472657373203d20223139322e3136382e302e3735222c206465736372697074696f6e203d20223c246465766963655f6c6170746f703e5c6eeb85b8ed8ab8ebb68132225d0a20207d0a20200a202067726f7570207b0a202020206465736372697074696f6e203d2022eca79120eb84a4ed8ab8ec9b8ced81ac220a20202020486f6d65526f757465723b0a20202020486f6d654e41543b0a20202020486f6d65436f6d313b0a20202020486f6d65436f6d323b0a20202020486f6d65436f6d333b0a20207d0a0a202067726f7570207b0a202020206465736372697074696f6e203d2022eab98ced8e9820eb84a4ed8ab8ec9b8ced81ac220a2020202043616665526f757465723b0a2020202043616665436f6d313b0a2020202043616665436f6d323b0a2020202043616665436f6d333b0a20207d0a7d0a40656e64756d6c0a40656e64756d6c"></p>

<p>여기서 인터넷 망은 모뎀 혹은 공유기에 연결되며 PC나 휴대론은 공유기에 연결되서 인터넷에 연결된다. 여기서 집 모뎀과 카페 공유기는 각각 <strong>카페 공유기 네트워크 망</strong>, <strong>집 공유기 네트워크 망</strong> 으로 각각 독립된 네트워크다.(LAN 망이라고도 한다.)</p>

<h3 id="각각의-네트워크-망은-내부ip를-이용해서-통신한다">각각의 네트워크 망은 내부IP를 이용해서 통신한다.</h3>

<p>위 그림에서 붉은색으로 표시된 IP는 집과 까페 네트워크에 중복해서 있는것을 볼 수 있다. 내부 내트워크 망에서서는 장비를 구분하기 위해 내부 IP주소를 사용하며 이 IP는 말그대로 내부 네트워크에서 사용되는 것이기 대문에 네트워크가 다르다면 중복가능하다. 즉 집과 까페에서 <strong>192.168.0.50</strong> ip 주소의 장비는 다른 장비다. 그렇기 때문에 집에서는 동작하는 원격이나 서버 접속이 다른곳에서 하면 안되는 것이다.</p>

<h3 id="어-그럼-네이버에서-ip찾기한담에-그걸로-접속하면-되겠내요">어?! 그럼 네이버에서 ip찾기한담에 그걸로 접속하면 되겠내요?</h3>

<p>위에서 파란색으로 표시된 ip주소가 우리집 혹은 까페의 네트워크 IP주소이며 네이버에서 <strong>내 ip확인</strong> 등으로 확인할 수 있다. 그러면 “어?! 저주소로 접속하면 되는거 아냐??” 라고 생각할 수 있다. 하지만 위 도식을 보자. 푸른색 ip로 지정된 네트워크 밑에 컴퓨터 노트북 휴대폰등 여러장비가 연결되어 있다. 그럼 저 IP로 접속했을 때 어디로 접속해야 할까?? 모호해진다. 여기서 IP주소 이외에 포트(PORT) 라는 개념이 등장한다.</p>

<h2 id="port">PORT</h2>

<p>위에서 IP주소로 네트워크에 접속한 장비 자체의 주소를 판단할 수 있다고 했다. 쉽게 포트는 네트워트에 접속한 장비에서 실행되는 프로그램에 접속할 수 있는 주소라고 보면 된다. 우리가 네트워크 를 통해 원격 데스크탑을 이용하는것을 예로 들어보자. 원격 데스크탑 역시 프로그램이다. 다른 장비에서 원격 데스크탑을 이용한다는 것은 다른 의미로 <strong>어떤 장비(IP)에 실행중인 원격 데스크탑 프로그램에 접속</strong>한다는 것을 의미한다. (원격도 하나의 프로그램이다.) 여기서 어떤 프로그램 을 구분할 수 있는 내용이 포트(PORT)다. 즉 어떤 장비(IP)의 어떤 프로그램(PORT) 에 접속 하는것. 그러면 위 도식은 아래와 같이 확장될 수 있다.</p>

<p><img class="plantuml" src="http://www.plantuml.com/plantuml/svg/~h407374617274756d6c0a407374617274756d6c0a21696e636c756465203c6f66666963652f436f6d6d756e69636174696f6e732f736d735f676174657761793e0a21696e636c756465203c6f66666963652f436f6d6d756e69636174696f6e732f736d74705f636f6e6e6563746f723e0a21696e636c756465203c6f66666963652f436f6d6d756e69636174696f6e732f766f69705f676174657761793e0a21696e636c756465203c6f66666963652f446576696365732f6d6f64656d3e0a21696e636c756465203c6f66666963652f446576696365732f776f726b73746174696f6e3e0a21696e636c756465203c6f66666963652f446576696365732f63656c6c5f70686f6e655f67656e657269633e0a21696e636c756465203c6f66666963652f446576696365732f6465766963655f6c6170746f703e0a0a6e7764696167207b0a20206e6574776f726b20496e7465726e6574207b0a20202020486f6d65526f75746572205b61646472657373203d20223c623e3c636f6c6f723a233030303066663e3131392e3135382e3230302e3134353c2f636f6c6f723e3c2f623e222c206465736372697074696f6e203d20223c24766f69705f676174657761793e5c6eec9db8ed84b0eb84b7ebaaa8eb8e80225d0a2020202043616665526f75746572205b61646472657373203d20223c623e3c636f6c6f723a233030303066663e3138372e3234352e3133312e3131323c2f636f6c6f723e3c2f623e222c206465736372697074696f6e203d20223c246d6f64656d3e5c6eeab98ced8ca8eab3b5ec9ca0eab8b05c6e28ebaaa8eb8e80eab3bc20eab3b5ec9ca0eab8b0eab0805c6eec9dbcecb2b4ed9895ec9db820eab2bdec9ab0eb8f8420ec9e88eb8ba42e29225d0a20207d0a2020486f6d65526f75746572202d2d20486f6d654e41540a2020486f6d654e4154205b61646472657373203d20223c623e3c636f6c6f723a236666303030303e3139322e3136382e302e313c2f636f6c6f723e3c2f623e222c206465736372697074696f6e203d20223c246d6f64656d3e5c6eeca791eab3b5ec9ca0eab8b0225d0a20200a20206e6574776f726b20486f6d65207b0a20202020486f6d654e41540a20202020486f6d65436f6d31205b61646472657373203d20223c623e3c636f6c6f723a236666303030303e3139322e3136382e302e35303c2f636f6c6f723e3c2f623e222c206465736372697074696f6e203d20223c24776f726b73746174696f6e3e5c6eeb8db0ec8aa4ed81aced8391225d0a20202020486f6d65436f6d32205b61646472657373203d20223139322e3136382e302e3730222c206465736372697074696f6e203d20223c246465766963655f6c6170746f703e5c6eeb85b8ed8ab8ebb681225d0a20202020486f6d65436f6d33205b61646472657373203d20223139322e3136382e302e3738222c206465736372697074696f6e203d20223c2463656c6c5f70686f6e655f67656e657269633e5c6eed9cb4eb8c80ed8fb0225d0a20207d0a2020486f6d65436f6d31202d2d2072656d6f74654170703b0a2020486f6d65436f6d32202d2d20736572764170703b0a202072656d6f7465417070205b61646472657373203d20223139322e3136382e302e37383a2a2a333338392a2a222c206465736372697074696f6e203d2022ec9b90eab2a9eb8db0ec8aa4ed81aced8391222c20636f6c6f72203d206f72616e67655d3b0a202073657276417070205b61646472657373203d20223139322e3136382e302e37383a2a2a393938372a2a222c206465736372697074696f6e203d2022ec849cebb284ed9484eba19ceab7b8eb9ea8222c20636f6c6f72203d206f72616e67655d3b0a0a20206e6574776f726b2043616665207b0a2020202043616665526f75746572205b61646472657373203d20223c623e3c636f6c6f723a236666303030303e3139322e3136382e302e313c2f636f6c6f723e3c2f623e225d0a2020202043616665436f6d31205b61646472657373203d20223139322e3136382e302e3330222c206465736372697074696f6e203d20223c24776f726b73746174696f6e3e5c6eeb8db0ec8aa4ed81aced8391225d0a2020202043616665436f6d32205b61646472657373203d20223c623e3c636f6c6f723a236666303030303e3139322e3136382e302e35303c2f636f6c6f723e3c2f623e222c206465736372697074696f6e203d20223c246465766963655f6c6170746f703e5c6eeb85b8ed8ab8ebb68131225d0a2020202043616665436f6d33205b61646472657373203d20223139322e3136382e302e3735222c206465736372697074696f6e203d20223c246465766963655f6c6170746f703e5c6eeb85b8ed8ab8ebb68132225d0a20207d0a20200a202067726f7570207b0a202020206465736372697074696f6e203d2022eca79120eb84a4ed8ab8ec9b8ced81ac220a20202020486f6d65526f757465723b0a20202020486f6d654e41543b0a20202020486f6d65436f6d313b0a20202020486f6d65436f6d323b0a20202020486f6d65436f6d333b0a20207d0a0a202067726f7570207b0a202020206465736372697074696f6e203d2022eab98ced8e9820eb84a4ed8ab8ec9b8ced81ac220a2020202043616665526f757465723b0a2020202043616665436f6d313b0a2020202043616665436f6d323b0a2020202043616665436f6d333b0a20207d0a7d0a40656e64756d6c0a40656e64756d6c"></p>

<p>포트는 공유기 PC모두 각각 각 장비마다 0~65565 번까지 가질 수 있다. 여기서 0~49151 번은 이미 예약된 포트로 생각하면 되며 일반적인 경우 49152~65535 까지를 일반 유저가 사용하는것이 좋다.</p>

<h2 id="먼가-외부에서-접속할-수-있는-방법이-보인다">먼가 외부에서 접속할 수 있는 방법이 보인다…</h2>

<p>네트워크 망의 ip주소와 내부 ip에서 실행중인 프로그램을 구분까지 할 수 있게 되었다. 그러면 아래 방법으로 외부에서 노트북으로 집에 있는 내 컴퓨터에 원격접속할 수 있지 않을까?? 가능하다. 공유기의 기능중 공유기 ip의 특정 포트로 접속한 경우 내부 네트워크의 특정 포트로 연결하는 <strong>포트 포워딩</strong>이라는 기능을 이용하면 접속가능하다.</p>

<p><img class="plantuml" src="http://www.plantuml.com/plantuml/svg/~h407374617274756d6c0a407374617274756d6c0a21696e636c756465203c6f66666963652f436f6d6d756e69636174696f6e732f736d735f676174657761793e0a21696e636c756465203c6f66666963652f436f6d6d756e69636174696f6e732f736d74705f636f6e6e6563746f723e0a21696e636c756465203c6f66666963652f436f6d6d756e69636174696f6e732f766f69705f676174657761793e0a21696e636c756465203c6f66666963652f446576696365732f6d6f64656d3e0a21696e636c756465203c6f66666963652f446576696365732f776f726b73746174696f6e3e0a21696e636c756465203c6f66666963652f446576696365732f63656c6c5f70686f6e655f67656e657269633e0a21696e636c756465203c6f66666963652f446576696365732f6465766963655f6c6170746f703e0a0a6167656e7420223c246465766963655f6c6170746f703e5c6eeb85b8ed8ab8ebb6812220617320636f6d310a636c6f756420696e7465726e65740a6167656e7420223c246d6f64656d3e5c6eeab3b5ec9ca0eab8b05c6e49503a3131392e3135382e3230302e31343522206173204e41540a6167656e7420223c24776f726b73746174696f6e3e5c6eeca79120ecbbb4ed93a8ed84b05c6e49503a3139322e3136382e302e35302220617320636f6d320a6167656e742022ec9b90eab2a920eb8db0ec8aa4ed81aced83915c6e506f72743a33333839222061732072656d6f74654170700a0a636f6d31202d722d3e20696e7465726e6574203a203131392e3135382e3230302e3134353a35303030315c6eec9cbceba19c20eca091ec868d0a696e7465726e6574202d722d3e204e41540a4e4154202d722d3e20636f6d32203a20353030303120ebb28820ed8faced8ab8eba19c20eca091ec868dec9d8420ec8b9ceb8f84ed959ceab2bdec9ab05c6ceca79120ecbbb4ed93a8ed84b0ec9d9820ec9b90eab2a920eb8db0ec8aa4ed81aced839120ed8faced8ab8283333383929eba19c20ec97b0eab2b00a636f6d32202d642d3e2072656d6f74654170700a0a40656e64756d6c0a40656e64756d6c"></p>

<h2 id="포트포워딩-세팅을-해보자">포트포워딩 세팅을 해보자</h2>

<p>필자가 가지고 있는 공유기가 iptime 것이라 iptime을 기준으로 설명한다.</p>

<h3 id="공유기-설정-패이지-접속">공유기 설정 패이지 접속</h3>

<p>우선 브라우저를 실행 후 주소에 <strong>192.168.0.1</strong> 을 입력해보자. 공유기 설정 패이지가 출력될 것이다. 공유기 설정 주소는 제조사 마다 다를 수 있기때문에 tplink 등 다른 공유기를 사용하고 있으면 설정 패이지에 들어가는 주소는 메뉴얼이나 검색해서 알아내도록 한다.</p>

<p><img src="/assets/images/2023/07/2023-07-31/04.png" alt="iptime 공유기 설정주소"></p>

<p><img src="/assets/images/2023/07/2023-07-31/05.png" alt="iptime 공유기 설정패이지"></p>

<p>설정페이지에서 로그인 후 관리도구로 들어가면 위 그림과 같은 현제 공유기의 외부ip(붉은색 사각형 으로표시된 부분)등 공유기 현재 상태에대한 정보를 확인 할 수 있다. 외부ip의 경우 네이버등 포털에서 “내 ip 찾기”로 확인한 ip와 동일하다.</p>

<h3 id="포트-포워딩-설정-항목-진입">포트 포워딩 설정 항목 진입</h3>

<p>공유기의 [NAT/라우터 관리] 항목에서 [포트포워드 설정] 항목으로 들어간다. 여기서 [새 규칙] 을 통해 포트포워드 규칙을 추가한다.</p>

<ul>
  <li>규칙이름
    <ul>
      <li>규칙이름은 내가 알기쉽게 정한다. 여기선 TEST_Remote_Outer라고 세팅한다.</li>
    </ul>
  </li>
  <li>내부 IP주소
    <ul>
      <li>포트포워딩을 통해 내가 접속하고자 하는 내부 장비의 IP를 지칭한다.</li>
      <li>위에서 확인한 컴퓨터 주소는 192.168.0.72 였다.</li>
    </ul>
  </li>
  <li>외부 포트 / 내부포트
    <ul>
      <li>외부포트 와 내부포트는 외부ip의 외부포트로 접속하면 이를 내부ip의 내부포트로 전환시키겠다는 의미다. 즉 현제 공유기 외부ip인 <strong>210.2.43.119 의 50001 번 포트로 접속</strong>하면 이를 내부ip <strong>192.168.0.72 의 3389번 포트</strong> 에 접속한것과 동일하게 처리하겠다 라는 의미이다.</li>
    </ul>
  </li>
</ul>

<p><img src="/assets/images/2023/07/2023-07-31/06.png" alt="포트포워딩 세팅"></p>

<p>규칙을 적용했으면 이제 테스트해보자</p>

<h3 id="포트포워딩을-이용한-외부접속">포트포워딩을 이용한 외부접속</h3>

<p>아까와 같이 원격접속을 해본다. 하지만 이번엔 내부ip로 접속하는것이 아니라 아까 포트포워딩 세팅한 210.2.43.119:50001 로 접속해본다.</p>

<p><img src="/assets/images/2023/07/2023-07-31/07.png" alt="포트포워딩을 통한 원격연결"></p>

<p>접속되는 것을 확인할 수 있다. 이주소는 외부 주소이므로 이 주소를 활용하면 외부에서도 우리집 네트워크에 접속하는게 가능하다.</p>

<h3 id="과연-이걸로-끝난걸까">과연 이걸로 끝난걸까..?</h3>

<p>외부에서 접속할수 있지만 이방법은 몇가지 문제가 있다. 우선</p>

<ol>
  <li>어색한 ip주소를 외우고 있어야 한다.</li>
  <li>이게 가장 큰 문제인대 일반 가정에서 사용하는 외부 ip는 계속 변경된다. ip는 한정적이기 때문에 인터넷 서비스업체(LG,KT,SK)에서는 할당되는 외부 IP를 수시로 갱신시키면서 미사용중인 ip를 정리하는등 ip가 불필요하게 낭비되지 않게한다.</li>
  <li>이때문에 나도 모르는 사이에 외부ip주소가 변경될 수 있고 그러면 역시 접속되던 것이 어느 순간 다시 안될 수 있다. 이경우 다시 외부ip를 확인하고 변경된 외부ip를 이용하는 수밖에 없다..</li>
</ol>

<p>회사같은 경우 외부ip를 인터넷 서비스 업체에 돈을 주고 계속 해서 고정시키기도 하지만 일반 가정에서 그럴수는 없기때문에 이를 보완할 방법이 필요하다.</p>

<h2 id="ddns">DDNS</h2>

<p>우리가 naver나 daum을 이용할 때 http://www.naver.com을 치고 들어가지 http://223.130.195.95를 치고 사이트에 접속하지는 않는다 이는 “naver.com” 이라는 문자열을 ip주소로 매칭시켜주기 때문인데 여기서 naver.com 을 도메인 이라고 하고 도메인을 ip로 변경해주는 곳을 도메인 네임 서버 라고 한다.</p>

<p><img class="plantuml" src="http://www.plantuml.com/plantuml/svg/~h407374617274756d6c0a407374617274756d6c0a21696e636c756465203c6f66666963652f436f6d6d756e69636174696f6e732f736d735f676174657761793e0a21696e636c756465203c6f66666963652f436f6d6d756e69636174696f6e732f736d74705f636f6e6e6563746f723e0a21696e636c756465203c6f66666963652f436f6d6d756e69636174696f6e732f766f69705f676174657761793e0a21696e636c756465203c6f66666963652f446576696365732f6d6f64656d3e0a21696e636c756465203c6f66666963652f446576696365732f776f726b73746174696f6e3e0a21696e636c756465203c6f66666963652f446576696365732f63656c6c5f70686f6e655f67656e657269633e0a21696e636c756465203c6f66666963652f446576696365732f6465766963655f6c6170746f703e0a0a6167656e7420223c24776f726b73746174696f6e3e5c6eecbbb4ed93a8ed84b02220617320636f6d310a636c6f756420696e7465726e65740a6167656e7420223c24776f726b73746174696f6e3e5c6e44444e53222061732064646e730a6167656e7420223c24776f726b73746174696f6e3e5c6e4e617665725c6e49503a3232332e3133302e3139352e393522206173204e617665720a0a636f6d31202d722d3e20696e7465726e6574203a206e617665722e636f6d20eca091ec868d0a696e7465726e6574202d722d3e2064646e73203a206e617665722e636f6d20ec9d9820697020eca1b0ed9a8c0a64646e73202d642d3e204e61766572203a203232332e3133302e3139352e393520eba19c20eca091ec868d20ed9598eb8f84eba19d20ecb298eba6ac0a4e61766572203c2d3e20636f6d31203a20ed86b5ec8ba00a0a6e6f7465206c656674206f66204e617665720a2020ec9b90eb9e98204e61766572ec998020ecbbb4ed93a8ed84b0ec9d9820ed86b5ec8ba0ec9d800a2020696e7465726e6574ec9d8420eab1b0ecb29820ec9db4eba484eca780eca780eba78c0a2020ed8eb8ec9d98ec838120eca781eca09120ec97b0eab2b0eba38c20ed919ced9884ed9688eb8ba42e0a656e64206e6f74650a0a40656e64756d6c0a40656e64756d6c"></p>

<h3 id="공유기-제조사에도-ddns-기능을-제공하는-곳이-있다">공유기 제조사에도 ddns 기능을 제공하는 곳이 있다.</h3>

<p>iptime, tplink등 커다란 공유기 회사는 자체 ddns기능을 지원한다. 이말인 즉슨 내 공유기의 도메인을 등록해 놓으면 네이버, 다음 처럼 도메인으로 우리집 네트워크에 접속할 수 있다는 것이고 ip가 변경되더라도 공유기 회사의 ddns기능을 통해 변경된 ip로 도메인이 자동으로 갱신되기 때문에 ip가 변경되는것에 대해 걱정하지 않아도 된다는 것이다(만세!)</p>

<h3 id="공유기-ddns-세팅">공유기 ddns 세팅</h3>

<p>포트 포워딩과 마찬가지로 ddns세팅은 공유기 설정 패이지에서 할 수 있다. iptime기준 [특수기능]의 [DDNS 설정]에서 내 공유기의 도메인을 할당 받을 수 있다. 필자는 이미 등록했기 때문에 스크린 샷처럼 나오지만 DDNS등록 버튼을 통해 자신의 도메인을 세팅할 수 있다. 참고로 iptime의 경우 도메인 주소가 [호스트이름].iptime.org 으로 고정되니 참고할것.</p>

<p><img src="/assets/images/2023/07/2023-07-31/08.png" alt="공유기 DDNS세팅"></p>

<h3 id="ddns-세팅은-공유기별로-저장된다">ddns 세팅은 공유기별로 저장된다</h3>

<p>ddns 세팅은 공유기 별로 설정된다. 그렇기 때문에 공유기를 변경하는 경우 기존 공유기에서 사용하던 도메인 제거 후 변경된 공유기에 ddns세팅을 해야한다. 참고</p>

<h3 id="도메인으로-접속해보자">도메인으로 접속해보자</h3>

<p>이제 도메인으로 장비에 접속해보자. 도메인을 설정했을므로 이제 ip대신 도메인 이름을 넣고 원격으로 붙어보자.</p>

<p><img src="/assets/images/2023/07/2023-07-31/09.png" alt="도메인을 이용한 접속"></p>

<p>접속이 잘 되는 것을 확인할 수 있다. 이제 포트포워딩과 DDNS기능을 통해 외부에서도 우리집 홈 네트워크에 접속할 수 있을것이다.</p>


    </div>

</article>
<div class="post-nav">
<a class="previous" href="/db/2023/07/30/MSSQL_%EC%99%B8%EB%B6%80%EC%A0%91%EC%86%8D_%EC%84%B8%ED%8C%85.html" title="MS-SQL 외부 접속 세팅">MS-SQL 외부 접속 세팅</a><span></span>
</div>
<div class="post-related">
      <div>Related Articles</div>
      <ul>
        <li><a class="post-link" href="/example/2017/12/08/mermaid-example.html" title="">Mermaid example</a></li>
<li><a class="post-link" href="/c++/2023/07/26/std-function_VS_%ED%95%A8%EC%88%98%ED%8F%AC%EC%9D%B8%ED%84%B0.html" title="">std::function_VS_함수포인터</a></li>
<li><a class="post-link" href="/markdown/2016/01/01/another-test-markdown.html" title="">Another test markdown</a></li>
<li><a class="post-link" href="/visual/studio/2023/07/03/Visua_Studio_%EA%B8%80%EA%BC%B4%EC%B6%94%EC%B2%9C.html" title="">Visual Studio 글꼴추천</a></li>
</ul>
    </div>
<div class="post-comments"></div></section>
</div>


  </section>
  <section class="sidebar" style="margin-left: 15px;">
    <!-- Get sidebar items --><style type="text/css" media="screen">
.post-menu ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
</style>

<div class="post-menu">
  <div class="post-menu-title">TOC</div>
  <div class="post-menu-content"></div>
</div>

<script>
  function generateContent() {
    var menu = document.querySelector(".post-menu");
    var menuContent =  menu.querySelector(".post-menu-content");
    var headings = document.querySelector(".post-content").querySelectorAll("h2, h3, h4, h5, h6");

    // Hide menu when no headings
    if (headings.length === 0) {
      return menu.style.display = "none";
    }

    // Generate post menu
    var menuHTML = '';
    for (var i = 0; i < headings.length; i++) {
      var h = headings[i];
      menuHTML += (
        '<li class="h-' + h.tagName.toLowerCase() + '">'
        + '<a href="#h-' + h.getAttribute('id') + '">' + h.textContent + '</a></li>');
    }

    menuContent.innerHTML = '<ul>' + menuHTML + '</ul>';

    // The header element
    var header = document.querySelector('header.site-header');

    function doMenuCollapse(index, over_items) {
      var items = menuContent.firstChild.children;

      if (over_items == undefined) {
        over_items = 20;
      }

      if (items.length < over_items) {
        return;
      }

      var activeItem = items[index];
      var beginItem = activeItem
      var endItem = activeItem
      var beginIndex = index;
      var endIndex = index + 1;
      while (beginIndex >= 0
        && !items[beginIndex].classList.contains('h-h2')) {
        beginIndex -= 1;
      }
      while (endIndex < items.length
        && !items[endIndex].classList.contains('h-h2')) {
        endIndex += 1;
      }
      for (var i = 0; i < beginIndex; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
      for (var i = beginIndex + 1; i < endIndex; i++) {
        item = items[i]
        // if (!item.classList.contains('h-h2')) {
          item.style.display = '';
        // }
      }
      for (var i = endIndex; i < items.length; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
    }

    // Init menu collapsed
    doMenuCollapse(-1);

    // Active the menu item
    window.addEventListener('scroll', function (event) {
      var lastActive = menuContent.querySelector('.active');
      var changed = true;
      var activeIndex = -1;
      for (var i = headings.length - 1; i >= 0; i--) {
        var h = headings[i];
        var headingRect = h.getBoundingClientRect();
        var headerRect = header.getBoundingClientRect();
        var headerTop = Math.floor(headerRect.top);
        var headerHeight = Math.floor(headerRect.height);
        var headerHeight = headerTop + headerHeight + 20;
        if (headingRect.top <= headerHeight) {
          var id = 'h-' + h.getAttribute('id');
          var a = menuContent.querySelector('a[href="#' + id  + '"]');
          var curActive = a.parentNode;
          if (curActive) {
            curActive.classList.add('active');
            activeIndex = i;
          }
          if (lastActive == curActive) {
            changed = false;
          }
          break;
        }
      }
      if (changed) {
        if (lastActive) {
          lastActive.classList.remove('active');
        }
        doMenuCollapse(activeIndex);
      }
      event.preventDefault();
    });
  }
  generateContent();
</script>
</section>
</div>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <div class="site-footer-inner">
<div>2023-2023 Seo Sang Hyok</div>
      <div>Powered by <a title="Jekyll is a simple, blog-aware, static site
      generator." href="https://jekyllrb.com/">Jekyll</a> &amp; <a title="Yat, yet
      another theme." href="https://github.com/jeffreytse/jekyll-theme-yat">Yat Theme</a>.</div>
      <div class="footer-col rss-subscribe">Subscribe <a href="/feed.xml">via RSS</a>
</div>
    </div>
  </div>
</footer>
</body>
</html>
